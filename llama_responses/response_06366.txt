Let's break this down step by step:

Elsa started with 40 marbles.

At breakfast, she lost 3 marbles, so she had 40 - 3 = 37 marbles left.

At lunchtime, she gave Susie 5 marbles, so she had 37 - 5 = 32 marbles left.

In the afternoon, Elsa's mom bought her a new bag with 12 marbles, so she now has 32 + 12 = 44 marbles.

Susie came back and gave Elsa twice as many marbles as she received at lunch, so she gave her 5 x 2 = 10 marbles.  Elsa now has 44 - 10 = 34 marbles.

Answer: 34