Let's start by identifying the amount of milk needed for 40 cookies. Since Juan needs 10 half-gallons of milk to bake 40 cookies, we know that 1 half-gallon is needed for 4 cookies. So, to bake 40 cookies, Juan would need 2 half-gallons of milk.

To bake 200 cookies, we need to know how many half-gallons of milk are needed. Since 1 half-gallon is needed for 4 cookies, we know that 1/4 gallon is needed for 16 cookies. So, to bake 200 cookies, Juan would need 12.5 gallons of milk.