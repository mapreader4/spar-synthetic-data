Let's break this down step by step.

Caleb started with 40 dandelion puffs. He gave 3 to his mom, so he has 40 - 3 = 37 left. Then, he gave 3 to his sister, leaving 37 - 3 = 34. Next, he gave 5 to his grandmother, leaving 34 - 5 = 29. Then, he gave 2 to his dog, leaving 29 - 2 = 27.

After that, he divided the remaining 27 dandelion puffs among his 3 friends. To do this, he gave 27 รท 3 = 9 to each friend. So, each friend received 9 dandelion puffs.